
## 一、什么是Binder

- 安卓的IPC机制
- Linux的驱动 /dev/binder
- 安卓系统中的Binder类,实现了IBinder接口

## 二、为什么增加Binder机制

> 安卓本身是一个linux系统,我们知道linux已经有一些进程通信方式,为什么安卓还需要单独新增呢?

- 常用的通信方式有:Socket,消息队列,管道和共享内存.
- 原因:主要是基于性能、稳定性和安全性几方面的考虑

#### 性能方面

- Socket：作为一款通用接口，起传输效率低，开销大，主要用在跨网络的进程间通信和本机上进程间的低速通信。
- 消息队列和管道：采用存储-转发方式，即数据先从发送方缓存区拷贝到内核开辟的缓存区中，然后再从内核缓存区拷贝到接收方缓存区，至少有两次拷贝过程。
- 共享内存：虽然无需拷贝，但控制复杂，难以使用。
- Binder：只需要一次数据拷贝，性能上仅次于共享内存。

#### 稳定性方面

#### 安全性方面

uid 标识进程

## 三、Binder数据传输机制

一次拷贝  拷贝到内核区，存在映射关系，然后另一个进程就拿到数据了

aidl 来实现的进程通信。

存在相同的aidl

- aidl 生成出来的代码必须看懂
- Proxy 发送数据，Stub 接收数据
- asInterface ： 先判断是否是同一进程，mRemote是服务端的代理。写到包里面去，发送。transact：绑定，挂起。（参数：调用哪个方法，0：双端通信）
- 服务端：onTransact(); 校验。